<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Gerador de Or√ßamentos Profissional - Crie or√ßamentos personalizados de forma r√°pida e f√°cil" />
  <meta name="theme-color" content="#0d7de0" />
  <title>Gerador de Or√ßamentos ‚Äî SoftPrime</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

  <!-- ========== TELA DE AUTENTICA√á√ÉO ========== -->
  <div id="authScreen" style="display:flex; min-height:100vh; background:linear-gradient(135deg, #667eea 0%, #764ba2 100%); align-items:center; justify-content:center; padding:20px;">
    <div style="background:#fff; border-radius:16px; box-shadow:0 20px 60px rgba(0,0,0,0.3); max-width:440px; width:100%; padding:40px;">
      
      <!-- Logo e T√≠tulo -->
      <div style="text-align:center; margin-bottom:32px;">
        <div style="background:linear-gradient(135deg,#0d7de0,#0a5fb8); color:#fff; padding:16px 24px; border-radius:12px; font-weight:700; font-size:24px; display:inline-block; margin-bottom:16px;">
          SoftPrime
        </div>
        <h2 style="margin:0; color:#1a1a1a; font-size:24px;">Gerador de Or√ßamentos</h2>
        <p style="color:#6b7280; margin-top:8px; font-size:14px;">Fa√ßa login ou crie sua conta</p>
      </div>

      <!-- Tabs: Login / Cadastro -->
      <div style="display:flex; gap:8px; margin-bottom:24px; border-bottom:2px solid #f3f4f6;">
        <button id="tabLogin" type="button" style="flex:1; padding:12px; border:none; background:transparent; cursor:pointer; font-weight:600; color:#0d7de0; border-bottom:3px solid #0d7de0; transition:all 0.3s; font-family:inherit;">
          Login
        </button>
        <button id="tabSignup" type="button" style="flex:1; padding:12px; border:none; background:transparent; cursor:pointer; font-weight:600; color:#6b7280; border-bottom:3px solid transparent; transition:all 0.3s; font-family:inherit;">
          Cadastrar
        </button>
      </div>

      <!-- Formul√°rio de Login -->
      <form id="loginForm" style="display:block;">
        <div style="margin-bottom:16px;">
          <label for="loginEmail" style="display:block; margin-bottom:6px; font-weight:600; font-size:14px; color:#4b5563;">
            Email
          </label>
          <input 
            type="email" 
            id="loginEmail" 
            placeholder="seu@email.com" 
            required
            style="width:100%; padding:12px; border:1.5px solid #d1d5db; border-radius:8px; font-size:14px; font-family:inherit;"
          />
        </div>

        <div style="margin-bottom:20px;">
          <label for="loginPassword" style="display:block; margin-bottom:6px; font-weight:600; font-size:14px; color:#4b5563;">
            Senha
          </label>
          <input 
            type="password" 
            id="loginPassword" 
            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" 
            required
            style="width:100%; padding:12px; border:1.5px solid #d1d5db; border-radius:8px; font-size:14px; font-family:inherit;"
          />
        </div>

        <button 
          type="submit" 
          style="width:100%; padding:14px; font-size:16px; margin-bottom:12px; background:#0d7de0; color:#fff; border:none; border-radius:8px; cursor:pointer; font-weight:600; font-family:inherit;"
        >
          üîê Entrar
        </button>

        <button 
          type="button" 
          id="forgotPasswordBtn"
          style="width:100%; padding:8px; background:transparent; border:none; color:#6b7280; font-size:14px; cursor:pointer; text-decoration:underline; font-family:inherit;"
        >
          Esqueci minha senha
        </button>
      </form>

      <!-- Formul√°rio de Cadastro -->
      <form id="signupForm" style="display:none;">
        <div style="margin-bottom:16px;">
          <label for="signupName" style="display:block; margin-bottom:6px; font-weight:600; font-size:14px; color:#4b5563;">
            Nome Completo
          </label>
          <input 
            type="text" 
            id="signupName" 
            placeholder="Seu nome completo" 
            required
            style="width:100%; padding:12px; border:1.5px solid #d1d5db; border-radius:8px; font-size:14px; font-family:inherit;"
          />
        </div>

        <div style="margin-bottom:16px;">
          <label for="signupEmail" style="display:block; margin-bottom:6px; font-weight:600; font-size:14px; color:#4b5563;">
            Email
          </label>
          <input 
            type="email" 
            id="signupEmail" 
            placeholder="seu@email.com" 
            required
            style="width:100%; padding:12px; border:1.5px solid #d1d5db; border-radius:8px; font-size:14px; font-family:inherit;"
          />
        </div>

        <div style="margin-bottom:20px;">
          <label for="signupPassword" style="display:block; margin-bottom:6px; font-weight:600; font-size:14px; color:#4b5563;">
            Senha (m√≠nimo 6 caracteres)
          </label>
          <input 
            type="password" 
            id="signupPassword" 
            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" 
            required
            minlength="6"
            style="width:100%; padding:12px; border:1.5px solid #d1d5db; border-radius:8px; font-size:14px; font-family:inherit;"
          />
        </div>

        <button 
          type="submit" 
          style="width:100%; padding:14px; font-size:16px; background:#0d7de0; color:#fff; border:none; border-radius:8px; cursor:pointer; font-weight:600; font-family:inherit;"
        >
          ‚ú® Criar Conta
        </button>
      </form>

      <!-- Mensagem de status -->
      <div id="authMessage" style="margin-top:16px; padding:12px; border-radius:8px; display:none; text-align:center; font-size:14px;"></div>

    </div>
  </div>

  <!-- ========== APLICA√á√ÉO PRINCIPAL ========== -->
  <div id="appScreen" style="display:block;">
    
    <header class="header">
      <div class="header-row">
        <div class="brand">
          <div class="logo">SoftPrime</div>
          <div class="site-title">Gerador de Or√ßamentos</div>
        </div>
        <div class="header-actions">
          <span id="userName" style="margin-right:12px; color:#4b5563; font-weight:500;"></span>
          <button id="exportCsvBtn" class="btn btn-ghost" title="Exportar todos os or√ßamentos para Excel">
            üìä Exportar Excel
          </button>
          <button id="exportDocBtn" class="btn btn-ghost" title="Exportar or√ßamento atual para Word">
            üìÑ Exportar Word
          </button>
        </div>
      </div>
    </header>

    <main class="wrap">
      <!-- Se√ß√£o de Emissores e Clientes -->
      <section class="card two-col">
        <div>
          <h4>üìù Dados do Emissor</h4>
          <form id="issuerForm" class="form-grid" autocomplete="off">
            <div class="full">
              <label for="issuerName" class="sr-only">Nome / Raz√£o social</label>
              <input id="issuerName" placeholder="Nome / Raz√£o social *" required aria-label="Nome do emissor" />
            </div>
            <div class="half">
              <label for="issuerCnpjCpf" class="sr-only">CPF / CNPJ</label>
              <input id="issuerCnpjCpf" placeholder="CPF / CNPJ" aria-label="CPF ou CNPJ do emissor" />
            </div>
            <div class="half">
              <label for="issuerPhone" class="sr-only">Telefone</label>
              <input id="issuerPhone" placeholder="Telefone" type="tel" aria-label="Telefone do emissor" />
            </div>
            <div class="full">
              <label for="issuerAddress" class="sr-only">Endere√ßo completo</label>
              <textarea id="issuerAddress" placeholder="Endere√ßo completo" rows="2" aria-label="Endere√ßo do emissor"></textarea>
            </div>
            <div class="form-actions">
              <button id="issuerSubmitBtn" class="btn btn-primary full" type="submit">Adicionar Emissor</button>
              <button id="issuerCancelBtn" class="btn btn-outline full" type="button">Cancelar</button>
            </div>
          </form>
          
          <div id="issuerListContainer" style="margin-top:20px;">
            <ul id="issuerList" class="list"></ul>
          </div>
        </div>

        <div>
          <h4>üë§ Dados do Cliente</h4>
          <form id="clientForm" class="form-grid" autocomplete="off">
            <div class="full">
              <label for="clientName" class="sr-only">Nome / Empresa</label>
              <input id="clientName" placeholder="Nome / Empresa *" required aria-label="Nome do cliente" />
            </div>
            <div class="half">
              <label for="clientCnpjCpf" class="sr-only">CPF / CNPJ</label>
              <input id="clientCnpjCpf" placeholder="CPF / CNPJ" aria-label="CPF ou CNPJ do cliente" />
            </div>
            <div class="half">
              <label for="clientPhone" class="sr-only">Telefone</label>
              <input id="clientPhone" placeholder="Telefone" type="tel" aria-label="Telefone do cliente" />
            </div>
            <div class="full">
              <label for="clientAddress" class="sr-only">Endere√ßo completo</label>
              <textarea id="clientAddress" placeholder="Endere√ßo completo" rows="2" aria-label="Endere√ßo do cliente"></textarea>
            </div>
            <div class="form-actions">
              <button id="clientSubmitBtn" class="btn btn-primary full" type="submit">Adicionar Cliente</button>
              <button id="clientCancelBtn" class="btn btn-outline full" type="button">Cancelar</button>
            </div>
          </form>
          
          <div id="clientListContainer" style="margin-top:20px;">
            <ul id="clientList" class="list"></ul>
          </div>
        </div>
      </section>

      <!-- Novo Or√ßamento -->
      <section class="card">
        <h4>üíº Novo Or√ßamento</h4>
        <div class="form-grid" style="margin-bottom:20px;">
          <div>
            <label for="selectIssuer" style="display:block;margin-bottom:6px;font-weight:600;font-size:14px;color:#4b5563;">
              Emissor *
            </label>
            <select id="selectIssuer" required aria-label="Selecione o emissor">
              <option value="">-- selecione o emissor --</option>
            </select>
          </div>
          <div>
            <label for="selectClient" style="display:block;margin-bottom:6px;font-weight:600;font-size:14px;color:#4b5563;">
              Cliente *
            </label>
            <select id="selectClient" required aria-label="Selecione o cliente">
              <option value="">-- selecione o cliente --</option>
            </select>
          </div>
        </div>

        <!-- Informa√ß√µes do Or√ßamento -->
        <div class="form-grid" style="margin-bottom:20px;padding:16px;background:#f9fafb;border-radius:8px;">
          <div>
            <label for="quoteNumber" style="display:block;margin-bottom:6px;font-weight:600;font-size:14px;color:#4b5563;">
              N√∫mero do Or√ßamento
            </label>
            <input id="quoteNumber" placeholder="Gerado automaticamente" readonly aria-label="N√∫mero do or√ßamento" />
          </div>
          <div>
            <label for="quoteDate" style="display:block;margin-bottom:6px;font-weight:600;font-size:14px;color:#4b5563;">
              Data
            </label>
            <input id="quoteDate" placeholder="Data atual" readonly aria-label="Data do or√ßamento" />
          </div>
        </div>

        <!-- Itens do Or√ßamento -->
        <div class="items-wrap">
          <h4 style="margin-bottom:12px;">üìã Itens do Or√ßamento</h4>
          <div style="overflow-x:auto;">
            <table class="items-table" id="itemsTable" aria-label="Tabela de itens do or√ßamento">
              <thead>
                <tr>
                  <th style="width:50%">Descri√ß√£o</th>
                  <th style="width:12%">Qtd</th>
                  <th style="width:16%">Unit. (R$)</th>
                  <th style="width:16%">Total (R$)</th>
                  <th style="width:6%"></th>
                </tr>
              </thead>
              <tbody id="itemsBody"></tbody>
            </table>
          </div>

          <div class="row-between" style="margin-top:16px;">
            <div>
              <button id="addItemBtn" class="btn btn-add">+ Adicionar Item</button>
            </div>
            <div style="display:flex;gap:20px;align-items:center;flex-wrap:wrap;">
              <div class="subtotal">Subtotal: R$ <strong><span id="subtotal">0.00</span></strong></div>
              <div class="total">Total: R$ <strong><span id="grandTotal">0.00</span></strong></div>
            </div>
          </div>
        </div>

        <!-- Observa√ß√µes -->
        <div style="margin-top:20px;">
          <label for="notes" style="display:block;margin-bottom:8px;font-weight:600;font-size:14px;color:#4b5563;">
            üìå Observa√ß√µes (opcional)
          </label>
          <textarea id="notes" rows="4" placeholder="Adicione observa√ß√µes, condi√ß√µes de pagamento, prazo de validade, etc." aria-label="Observa√ß√µes do or√ßamento"></textarea>
        </div>
      </section>

      <!-- Bot√µes de A√ß√£o -->
      <div class="generate-wrap">
        <button id="saveQuoteBtn" class="btn btn-primary btn-generate">
          üìÑ Gerar Or√ßamento
        </button>
        <button id="cancelEditBtn" class="btn btn-outline" style="width:100%;margin-top:12px;">
          Cancelar Edi√ß√£o
        </button>
      </div>

      <!-- Or√ßamentos Salvos -->
      <section class="card">
        <h4>üíæ Or√ßamentos Salvos</h4>
        <ul id="quotesList" class="list" aria-label="Lista de or√ßamentos salvos"></ul>
      </section>
    </main>

    <!-- Modal de Preview -->
    <div id="previewModal" class="modal hidden" aria-hidden="true" role="dialog" aria-labelledby="previewTitle">
      <div class="modal-box">
        <button id="closePreview" class="modal-close" aria-label="Fechar visualiza√ß√£o">√ó</button>
        <h3 id="previewTitle" style="margin-bottom:20px;font-size:20px;">Visualiza√ß√£o do Or√ßamento</h3>
        <div id="previewArea" style="border:1px solid #e5e7eb;padding:20px;border-radius:8px;background:#fff;"></div>
        <div class="modal-actions">
          <button id="printBtn" class="btn btn-primary">üñ®Ô∏è Imprimir / Salvar PDF</button>
        </div>
      </div>
    </div>

    <footer class="footer">
      <p>¬© 2026 Desenvolvido por <strong>SoftPrime</strong> - Todos os direitos reservados</p>
    </footer>

  </div>
  <!-- FIM DA APLICA√á√ÉO PRINCIPAL -->

  <!-- JavaScript INLINE (SEM ARQUIVOS EXTERNOS) -->
  <script>
    // TROCA DE ABAS
    document.addEventListener('DOMContentLoaded', () => {
      console.log('‚úÖ Sistema carregado');
      
      const tabLogin = document.getElementById('tabLogin');
      const tabSignup = document.getElementById('tabSignup');
      const loginForm = document.getElementById('loginForm');
      const signupForm = document.getElementById('signupForm');
      const forgotPasswordBtn = document.getElementById('forgotPasswordBtn');
      const authMessage = document.getElementById('authMessage');

      function showMessage(msg, type = 'info') {
        if (!authMessage) return;
        authMessage.textContent = msg;
        authMessage.style.display = 'block';
        
        if (type === 'success') {
          authMessage.style.background = '#d1fae5';
          authMessage.style.color = '#065f46';
          authMessage.style.border = '1px solid #6ee7b7';
        } else if (type === 'error') {
          authMessage.style.background = '#fee2e2';
          authMessage.style.color = '#991b1b';
          authMessage.style.border = '1px solid #fca5a5';
        } else {
          authMessage.style.background = '#dbeafe';
          authMessage.style.color = '#1e40af';
          authMessage.style.border = '1px solid #93c5fd';
        }

        setTimeout(() => { authMessage.style.display = 'none'; }, 5000);
      }

      function switchToLogin() {
        console.log('‚Üí Login');
        tabLogin.style.color = '#0d7de0';
        tabLogin.style.borderBottom = '3px solid #0d7de0';
        tabSignup.style.color = '#6b7280';
        tabSignup.style.borderBottom = '3px solid transparent';
        loginForm.style.display = 'block';
        signupForm.style.display = 'none';
        authMessage.style.display = 'none';
      }

      function switchToSignup() {
        console.log('‚Üí Cadastro');
        tabSignup.style.color = '#0d7de0';
        tabSignup.style.borderBottom = '3px solid #0d7de0';
        tabLogin.style.color = '#6b7280';
        tabLogin.style.borderBottom = '3px solid transparent';
        signupForm.style.display = 'block';
        loginForm.style.display = 'none';
        authMessage.style.display = 'none';
      }

      tabLogin.onclick = (e) => { e.preventDefault(); switchToLogin(); };
      tabSignup.onclick = (e) => { e.preventDefault(); switchToSignup(); };

      loginForm.onsubmit = (e) => {
        e.preventDefault();
        const email = document.getElementById('loginEmail').value.trim();
        const password = document.getElementById('loginPassword').value;
        if (!email || !password) { showMessage('Preencha todos os campos', 'error'); return; }
        showMessage('Login tempor√°rio - configure Supabase para funcionar', 'info');
        // TODO: Integrar com Supabase
      };

      signupForm.onsubmit = (e) => {
        e.preventDefault();
        const name = document.getElementById('signupName').value.trim();
        const email = document.getElementById('signupEmail').value.trim();
        const password = document.getElementById('signupPassword').value;
        if (!name || !email || !password) { showMessage('Preencha todos os campos', 'error'); return; }
        if (password.length < 6) { showMessage('Senha m√≠nima: 6 caracteres', 'error'); return; }
        showMessage('Cadastro tempor√°rio - configure Supabase para funcionar', 'success');
        signupForm.reset();
        setTimeout(switchToLogin, 2000);
      };

      forgotPasswordBtn.onclick = (e) => {
        e.preventDefault();
        const email = document.getElementById('loginEmail').value.trim();
        if (!email) { showMessage('Digite seu email no campo acima', 'error'); return; }
        if (confirm(`Enviar email para ${email}?`)) {
          showMessage('Recupera√ß√£o de senha - configure Supabase para funcionar', 'info');
        }
      };

      switchToLogin();
    });
  </script>
  
  <script src="app.js"></script>
</body>
</html>